---
title: "catdog_data_plotting_v1"
author: "Stephanie Huang"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# SETUP

### Load in Packages

```{r}
library(readr) # read_csv
library(dplyr) #data wrangling
library(ggplot2) #graphs
library(stringr) # str_detect
library(RColorBrewer) #scale_fill_brewer
```


### Read in the data
```{r}
#Set working directory to source file location 
catdog <- read_csv("cleaned_catdog_data_v1.csv")

```


### Animals with your name?
```{r}
#By specific cases
my_name <- catdog %>%
  filter(name %in% c("Stephanie", "Steph", "Stephy",
                     "Stephie", "Stefanie"))

#Starting with
my_name_2 <- catdog %>%
  filter(str_detect(name, "^Steph|^Stef"))

```


### Cat as cat Dog as dog
```{r}
catascat <- filter(catdog, breed == "Cat")
dogasdog <- filter(catdog, breed == "Dog")

```


## Top cat & dog names
### Names sorted by type
```{r}
nm_x_typ <- catdog %>%
  group_by(type) %>%
  count(name, sort = TRUE) %>%
  slice_max(n, n = 10)

# #just to look at the silly uncommon names (2 pac the cat)
# bot_nm_x_type <- catdog %>%
#   group_by(type) %>%
#   count(name, sort = TRUE) %>%
#   filter(n <= 2)

```

### Make the bar plot
```{r}
bar_plot <- nm_x_typ %>%
  filter(type == "Cat") %>%
  ggplot(aes(x = reorder(name, n),
             y = n,
             fill = reorder(name, n)))

my_bar_plot <- bar_plot +
  geom_col(color = "grey10", alpha = 0.7) +
  labs(x = "Name", y = "Number of Cats",
       title = "Top 10 Cat Names") +
  scale_fill_brewer(palette = "Spectral") +
  coord_flip() +
  theme_classic()

plot(my_bar_plot)
```


### Boxplots for animal age
#### To add
```{r}
#boxplots

```


### Extras
#### Pie graph (base R pie)
<https://www.learnbyexample.org/r-pie-chart-base-graph/>
```{r}

brd_x_typ <- catdog %>%
  group_by(type) %>%
  summarize(breeds = n_distinct(breed)) %>%
  mutate(pct = breeds/sum(breeds) * 100)

#round down to 2 
brd_x_typ$pct <- signif(brd_x_typ$pct, 2)

percent2plot <- paste(brd_x_typ$type, brd_x_typ$pct, "%")

#pie chart
pie(brd_x_typ$breeds, labels = percent2plot,
    col = c("lightpink", "lightblue"),
    main = "Percentage of unique breeds across animal type")

```

#### Pie graph 2 (ggplot)
```{r}
pcb <- catdog %>% 
  filter(type == "Cat") %>%
  count(breed, sort = TRUE) %>%
  slice_max(n, n = 15) %>%
  ggplot(aes(x = "", y = n, fill = breed))

p_pcb <- pcb +
  geom_col(color = "grey10", alpha = 0.6) +
  # geom_label(aes(label = n),
  #            position = position_stack(vjust = 0.5),
  #            show.legend = FALSE) +
  coord_polar(theta = "y") +
  theme_classic()
  
plot(p_pcb)
```
